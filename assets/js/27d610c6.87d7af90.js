"use strict";(self.webpackChunkrill_flow_github_io=self.webpackChunkrill_flow_github_io||[]).push([[1826],{5220:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>d,default:()=>o,frontMatter:()=>i,metadata:()=>l,toc:()=>h});var r=s(5893),t=s(1151);const i={sidebar_position:7},d="API \u6587\u6863",l={id:"user-guide/api",title:"API \u6587\u6863",description:"\u91cd\u70b9API",source:"@site/docs/user-guide/07-api.md",sourceDirName:"user-guide",slug:"/user-guide/api",permalink:"/docs/user-guide/api",draft:!1,unlisted:!1,editUrl:"https://github.com/rill-flow/rill-flow.github.io/edit/main/docs/user-guide/07-api.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7},sidebar:"tutorialSidebar",previous:{title:"\u89e6\u53d1\u5668\u7ba1\u7406",permalink:"/docs/user-guide/background/trigger"},next:{title:"\u6700\u4f73\u5b9e\u8df5",permalink:"/docs/category/\u6700\u4f73\u5b9e\u8df5"}},c={},h=[{value:"\u91cd\u70b9API",id:"\u91cd\u70b9api",level:2},{value:"\u521b\u5efa\u5de5\u4f5c\u6d41",id:"\u521b\u5efa\u5de5\u4f5c\u6d41",level:3},{value:"\u6267\u884c\u5de5\u4f5c\u6d41",id:"\u6267\u884c\u5de5\u4f5c\u6d41",level:3},{value:"\u4efb\u52a1\u5b8c\u6210\u56de\u8c03",id:"\u4efb\u52a1\u5b8c\u6210\u56de\u8c03",level:3},{value:"\u83b7\u53d6\u5de5\u4f5c\u6d41\u6267\u884c\u60c5\u51b5",id:"\u83b7\u53d6\u5de5\u4f5c\u6d41\u6267\u884c\u60c5\u51b5",level:3},{value:"\u5176\u4ed6API",id:"\u5176\u4ed6api",level:2}];function x(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"api-\u6587\u6863",children:"API \u6587\u6863"}),"\n",(0,r.jsx)(e.h2,{id:"\u91cd\u70b9api",children:"\u91cd\u70b9API"}),"\n",(0,r.jsx)(e.h3,{id:"\u521b\u5efa\u5de5\u4f5c\u6d41",children:"\u521b\u5efa\u5de5\u4f5c\u6d41"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"URL"}),"\uff1a/flow/bg/manage/descriptor/add_descriptor.json"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42\u65b9\u5f0f"}),"\uff1aPOST"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42\u53c2\u6570\u8bf4\u660e"})}),"\n"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u53c2\u6570\u540d\u79f0"}),(0,r.jsx)(e.th,{children:"\u5fc5\u586b"}),(0,r.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"business_id"}),(0,r.jsx)(e.td,{children:"\u662f"}),(0,r.jsx)(e.td,{children:"String"}),(0,r.jsx)(e.td,{children:"\u5de5\u4f5c\u6d41\u4e1a\u52a1ID"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"feature_name"}),(0,r.jsx)(e.td,{children:"\u662f"}),(0,r.jsx)(e.td,{children:"String"}),(0,r.jsx)(e.td,{children:"\u5de5\u4f5c\u6d41\u670d\u52a1\u540d\u79f0"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"alias"}),(0,r.jsx)(e.td,{children:"\u662f"}),(0,r.jsx)(e.td,{children:"String"}),(0,r.jsx)(e.td,{children:"\u5de5\u4f5c\u6d41\u522b\u540d"})]})]})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42Body\u53c2\u6570"}),"\uff1a\u5de5\u4f5c\u6d41yaml\u5b9a\u4e49"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42\u793a\u4f8b"}),"\uff1a"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-curl",children:"curl --location --request POST 'http://127.0.0.1:8080/flow/bg/manage/descriptor/add_descriptor.json?business_id=demoFlowTest &feature_name=demoFlowTest &alias=release' \\\n--header 'Content-Type: text/plain' \\\n--data-raw '---\nversion: 20230829         \nworkspace: demoFlowTest    \ndagName: demoTest         \ntype: flow                \ntasks:\n  - category: function     \n    name: startNode        \n    next: endNode         \n    resourceName: http://127.0.0.1:8080/flow/sample/start_node.json  \n    pattern: task_sync     \n    inputMappings:         \n      - target: $.input.right\n        source: $.context.right\n      - target: $.input.left\n        source: $.context.left\n    outputMappings:       \n      - target: $.context.result_number\n        source: $.output.result_number\n  - category: function\n    name: endNode\n    resourceName: http://127.0.0.1:8080/flow/sample/end_node.json\n    pattern: task_sync\n    inputMappings:\n      - target: $.input.result_number\n        source: $.context.result_number\n      - target: $.input.expect_number\n        source: $.context.result_number\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8fd4\u56de\u7ed3\u679c"}),"\uff1a"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-txt",children:'{\n    "ret": true, // \u521b\u5efa\u6210\u529f\uff1atrue\uff0c\u521b\u5efa\u5931\u8d25\uff1afalse\n    "descriptor_id": "" // \u5de5\u4f5c\u6d41ID\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u6267\u884c\u5de5\u4f5c\u6d41",children:"\u6267\u884c\u5de5\u4f5c\u6d41"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"URL"}),"\uff1a/flow/submit.json"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42\u65b9\u5f0f"}),"\uff1aPOST"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42\u53c2\u6570\u8bf4\u660e"})}),"\n"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u53c2\u6570\u540d\u79f0"}),(0,r.jsx)(e.th,{children:"\u5fc5\u586b"}),(0,r.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"descriptor_id"}),(0,r.jsx)(e.td,{children:"\u662f"}),(0,r.jsx)(e.td,{children:"String"}),(0,r.jsx)(e.td,{children:"\u5de5\u4f5c\u6d41ID"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"callback"}),(0,r.jsx)(e.td,{children:"\u5426"}),(0,r.jsx)(e.td,{children:"String"}),(0,r.jsx)(e.td,{children:"\u6267\u884c\u5b8c\u6210\u540e\u7684\u56de\u8c03\u5730\u5740"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"resource_check"}),(0,r.jsx)(e.td,{children:"\u5426"}),(0,r.jsx)(e.td,{children:"String"}),(0,r.jsx)(e.td,{children:"\u8d44\u6e90\u68c0\u6d4b\u89c4\u5219"})]})]})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42Body\u53c2\u6570"}),"\uff1a\u5de5\u4f5c\u6d41\u6267\u884c\u7684context\u4fe1\u606f"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42\u793a\u4f8b"}),"\uff1a"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-curl",children:"curl -XPOST 'http://127.0.0.1:8080/2/flow/submit.json?descriptor_id=demoFlowTest:demoTest' -d '{\"left\": 512, \"right\": 512}' -H'Content-Type:application/json'\n"})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8fd4\u56de\u7ed3\u679c"}),"\uff1a"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-txt",children:'{\n    "execution_id": "" // \u6267\u884cID\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u4efb\u52a1\u5b8c\u6210\u56de\u8c03",children:"\u4efb\u52a1\u5b8c\u6210\u56de\u8c03"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"URL"}),"\uff1a/flow/finish.json"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42\u65b9\u5f0f"}),"\uff1aPOST"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42\u53c2\u6570\u8bf4\u660e"})}),"\n"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u53c2\u6570\u540d\u79f0"}),(0,r.jsx)(e.th,{children:"\u5fc5\u586b"}),(0,r.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"executionId"}),(0,r.jsx)(e.td,{children:"\u662f"}),(0,r.jsx)(e.td,{children:"String"}),(0,r.jsx)(e.td,{children:"\u6267\u884cID"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"taskName"}),(0,r.jsx)(e.td,{children:"\u662f"}),(0,r.jsx)(e.td,{children:"String"}),(0,r.jsx)(e.td,{children:"\u4efb\u52a1\u540d\u79f0"})]})]})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42Body\u53c2\u6570\u793a\u4f8b"})}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-txt",children:'{\n  "result_type": "SUCCESS", // \u4efb\u52a1\u6267\u884c\u7ed3\u679c\uff1a\u6210\u529f - SUCCESS\uff0c\u5931\u8d25 - FAIL\n  "passthrough": {\n    "execution_id": "882a5c3b-82be-4570-99f7-15bb2b1c0dce",\n    "task_name": "A" // \u5b8c\u6210\u7684\u4efb\u52a1\u540d\u79f0\n  },\n  "response": { // \u9700\u66f4\u65b0\u7684\u4e0a\u4e0b\u6587\u5185\u5bb9\uff0coutputMappings\u4e2d\u4f7f\u7528\n    "xxx": "xxx"\n  }\n}\n'})}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8fd4\u56de\u7ed3\u679c"}),"\uff1a"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-txt",children:'{\n    "result": "ok" \n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u83b7\u53d6\u5de5\u4f5c\u6d41\u6267\u884c\u60c5\u51b5",children:"\u83b7\u53d6\u5de5\u4f5c\u6d41\u6267\u884c\u60c5\u51b5"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"URL"}),"\uff1a/flow/get.json"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42\u65b9\u5f0f"}),"\uff1aGET"]}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.strong,{children:"\u8bf7\u6c42\u53c2\u6570\u8bf4\u660e"})}),"\n"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u53c2\u6570\u540d\u79f0"}),(0,r.jsx)(e.th,{children:"\u5fc5\u586b"}),(0,r.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"execution_id"}),(0,r.jsx)(e.td,{children:"\u662f"}),(0,r.jsx)(e.td,{children:"String"}),(0,r.jsx)(e.td,{children:"\u5de5\u4f5c\u6d41\u6267\u884cID"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"brief"}),(0,r.jsx)(e.td,{children:"\u5426"}),(0,r.jsx)(e.td,{children:"boolean"}),(0,r.jsx)(e.td,{children:"\u662f\u5426\u8fd4\u56de\u7b80\u7565\u4fe1\u606f\uff08true\uff1a\u53ea\u8fd4\u56de\u5de5\u4f5c\u6d41\u672c\u8eab\u6267\u884c\u60c5\u51b5\uff0cfalse\uff1a\u8fd4\u56de\u5de5\u4f5c\u6d41\u53ca\u5404\u8282\u70b9\u6267\u884c\u60c5\u51b5\uff09"})]})]})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8fd4\u56de\u7ed3\u679c"}),"\uff1a"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-txt",children:'{\n    "ret": {\n        "execution_id": "", // \u5de5\u4f5c\u6d41\u6267\u884cID\n        "dag_status": "RUNNING", // \u5de5\u4f5c\u6d41\u6267\u884c\u72b6\u6001\n        "process": 100, //\n\n \u5de5\u4f5c\u6d41\u5f53\u524d\u6267\u884c\u8fdb\u5ea6\uff08100\u4ee3\u8868100%\uff09\n        "tasks": {  // brief\u4e3atrue\u65f6\u4e0d\u8fd4\u56detasks\u3002tasks\u662f\u4ee5\u8282\u70b9\u540d\u79f0\u4e3akey\uff0c\u8282\u70b9\u4fe1\u606f\u4e3avalue\u7684map\u7ed3\u6784\n            "startNode": {\n                "contains_sub": false, // \u662f\u5426\u5305\u542b\u5b50\u8282\u70b9\n                "name": "startNode", // \u8282\u70b9\u540d\u79f0\n                "next": ["endNode"], // \u4e0b\u4e00\u4e2a\u8282\u70b9\u540d\u79f0\n                "status": "NOT_STARTED", // \u8282\u70b9\u72b6\u6001\n                "task": {    \n                  "name": "startNode",\n                  "next": "endNode",\n                  "resourceName": "http://127.0.0.1:8080/flow/sample/start_node.json", \n                  "pattern": "task_sync", \n                  "inputMappings": [  // \u8f93\u5165\u6620\u5c04\u89c4\u5219\n                    ...\n                  ],\n                  "outputMappings": [  // \u8f93\u51fa\u6620\u5c04\u89c4\u5219\n                    ...\n                  ]\n                }\n            },\n            "endNode": {\n                ...\n            }\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u5176\u4ed6api",children:"\u5176\u4ed6API"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsxs)(e.strong,{children:["\u9879\u76ee\u5df2\u96c6\u6210",(0,r.jsx)(e.a,{href:"https://swagger.io/",children:"Swagger2"}),"\u6846\u67b6\uff0c\u5b8c\u6574\u63a5\u53e3\u63cf\u8ff0\u53ef\u5728\u670d\u52a1\u542f\u52a8\u540e\u8bbf\u95ee\u4ee5\u4e0b\u5730\u5740"]}),"\uff1a"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-txt",children:"http://127.0.0.1:8080/swagger-ui.html\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u6548\u679c\u5982\u4e0b\u56fe\uff1a"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.img,{alt:"SWAGGER",src:s(6540).Z+"",width:"2050",height:"998"})})]})}function o(n={}){const{wrapper:e}={...(0,t.a)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(x,{...n})}):x(n)}},6540:(n,e,s)=>{s.d(e,{Z:()=>r});const r=s.p+"assets/images/swagger-de21d48a14c9457c48c7753b7a89fe43.jpg"},1151:(n,e,s)=>{s.d(e,{Z:()=>l,a:()=>d});var r=s(7294);const t={},i=r.createContext(t);function d(n){const e=r.useContext(i);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:d(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);